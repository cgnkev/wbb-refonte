{% extends "::base.html.twig" %}
{% block meta %}<meta name="description" content="World Best Bars" />{% endblock %}
{% block title %}World Best Bars{% endblock %}

{% block bodyTag %}
<body class="index">
{% endblock %}
{% block body %}
<div class="full-cream">

    <!-- SUBHEADER -->
    <div class="container">

        <section class="sub-header">

            {% if not is_mobile() or is_tablet() %}
            <table>
                <tr>
                    <td>
                        <div class="city-selector h3">
                            You are in
                            <select class="ui-dropdown" name="city" data-class="with-icon city" id="city_selector">
                                <option disabled="disabled">Choose a City</option>
                                {% for c in topCities %}
                                    <option data-type="redirect" value="{{ path('city_bar_guides',{slug:c.slug}) }}"
                                            {% if city is defined and c.id==city.id %}
                                                selected="selected"
                                            {% endif %}
                                            >{{ c.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </td>

                    <td class="title">
                        <h1>Popular Bars</h1>
                    </td>

                    <td></td>
                </tr>
            </table>
            {% else %}
            <h1>Popular Bars</h1>
            {% endif %}
        </section>
    </div>

    <!-- BARS -->
    <div class="container full">

        <section class="bars">

            {% if is_mobile() and not is_tablet() %}

            <div class="force-load">
                {% for b in popularBars %}
                    {% include "WBBBarBundle:Bar:bar2.html.twig" with { 'b': b } %}
                {% endfor %}
            </div>

            {% else %}

            <div class="ui-slider type-bar has_sizer arrows dots" data-size="12x3" data-display="3">
                {% for b in popularBars %}
                    <div class="ui-slide">
                       {% include "WBBBarBundle:Bar:bar1.html.twig" with { 'b': b } %}
                    </div>
                {% endfor %}
            </div>

            {% endif %}

        </section>
    </div>

    <!-- BEST OF -->
    <div class="container">

        <div class="twelve columns">

            <section class="bestof">
                <div class="align-center l-margin">
                    <h1>Best Of</h1>
                </div>
                {% if is_mobile() and not is_tablet() %}
                    <div class="ui-slider type-bestof has_sizer arrows dots" data-size="4x3" data-display="1">
                {% else %}
                    <div class="ui-slider type-bestof has_sizer arrows dots" data-size="3x3" data-display="3">
                {% endif %}
                    {% for b in topBestofs %}
                        <div class="ui-slide">
                            {% include "WBBBarBundle:Bar:bestof.html.twig" with { 'b': b } %}
                        </div>
                    {% endfor %}
                </div>
            </section>
        </div>
    </div>

    <!-- BAR FILTER -->

    <section class="bar-filter">

        <div class="container s-margin-bottom">

            <div class="twelve columns">
                <hr class="l-margin-top m-margin-bottom"/>
            </div>

            <div class="six columns h2">

                <input type="radio" name="filter" value="bar_list" class="ui-radio" data-color="brown" data-type="collapsed" checked="checked"/>
                <input type="radio" name="filter" value="best_of" class="ui-radio" data-color="brown" data-type="collapsed"/>
            </div>

            <div class="six columns sort-by h3">

                <span class="sort">Sort by :</span>

                <select class="ui-dropdown light" name="city">
                    <option value="popularity">Popularity</option>
                    <option value="date">Date</option>
                    <option value="distance">Distance</option>
                    <option value="alphabet">Alphabetical order</option>
                </select>

                <input type="radio" name="view-type" value="grid" class="ui-radio with-icon" data-color="brown" checked="checked"/>
                <input type="radio" name="view-type" value="list" class="ui-radio with-icon" data-color="brown"/>
            </div>
        </div>

        <div class="container">

            <div class="bars-w-pic force-load  <?php if($is_mobile): ?>m-margin-top<?php endif ?> load-container">

                <?php for($i=1; $i<13; $i++) : ?>
                {% if not is_mobile() or is_tablet() %}<div class="three columns m-margin-top">{% endif %}
                    <?php include('components/bar-w-pic.php') ?>
                {% if not is_mobile() or is_tablet() %}</div>{% endif %}
                <?php endfor ?>

                <div class="load-target"></div>

                <div class="twelve columns align-center m-margin load-more-container">
                    <a class="h4 btn-radius large border load-more brown" href="tmp/data/bar.php?<?=$is_mobile?'&mobile':''?>">See more bars</a>
                </div>

            </div>

            <div class="bars-w-pic-list load-container" style="display: none">

                <?php for($i=1; $i<6; $i++) : ?>
                <?php include('components/bar-w-pic-list.php') ?>
                <?php endfor ?>

                <div class="load-target"></div>

                <div class="twelve columns align-center m-margin load-more-container">
                    <a class="h4 btn-radius large border load-more brown" href="tmp/data/bar.php?list=1<?=$is_mobile?'&mobile':''?>">See more bars</a>
                </div>

            </div>

        </div>

        <script type="text/javascript">

            $('input[name=view-type]').change(function()
            {
                if( $(this).val() == "grid")
                {
                    $('.bars-w-pic-list').fadeOut(200, 'easeInOutCubic', function()
                    {
                        $('.bars-w-pic').show();

                        var $elements = $('.bars-w-pic article');

                        $elements.addClass('enable3d').css({opacity:0, top:'6em', position:'relative'}).each(function(index){

                            $(this).delay(60*(index+1)).velocity({opacity:1, top:0}, 600, 'easeInOutCubic');
                        });
                    });
                }
                else
                {
                    $('.bars-w-pic').fadeOut(200, 'easeInOutCubic', function()
                    {
                        $('.bars-w-pic-list').show();

                        var $elements = $('.bars-w-pic-list article');

                        $elements.addClass('enable3d').css({opacity:0, top:'6em', position:'relative'}).each(function(index){

                            $(this).delay(100*(index+1)).velocity({opacity:1, top:0}, 600, 'easeInOutCubic');
                        });
                    });
                }
            });

        </script>

    </section>
</div>
{% endblock %}