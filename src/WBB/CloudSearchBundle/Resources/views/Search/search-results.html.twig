{% extends "::base.html.twig" %}

{% block bodyTag %}
    <body class="search">
    {% endblock %}

    {% block body %}
        <div class="container l-padding">
            <aside class="three columns filters">
                <form id="filter">
                    <div class="reset m-margin-bottom">
                        <h3>Filters</h3>
                        <input type="reset" value="{% if is_mobile() and not is_tablet() %} {% else %}Reset{% endif %}"/>
                    </div>
                    <ul>
                        <li>
                            <div class="drop-btn">
                                <h3>Location</h3>
                                <a class="btn-round plus brown"></a>
                            </div>

                            <div class="drop-list">
                                {% if is_mobile() and not is_tablet() %}<label class="h3">City</label>{% endif %}

                                <select class="ui-dropdown" name="city" data-class="city">
                                    <option disabled="disabled">Choose a City</option>
                                    {% for city in cities %}
                                        <option value="{{ city.slug }}">{{ city.name }}</option>
                                    {% endfor %}
                                </select>

                                <div class="neigborhood">
                                    <label class="h3">Neigborhood</label>
                                    <ul></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="drop-btn">
                                <h3>Bar style</h3>
                                <a class="btn-round plus brown"></a>
                            </div>

                            <div class="drop-list">
                                <ul class="checkbox-container">
                                    <li><label><input type="checkbox" name="neigborhood[]" value="brooklyn"/><b></b>Hotel Bar</label></li>
                                    <li><label><input type="checkbox" name="neigborhood[]" value="brooklyn"/><b></b>Amazing Views</label></li>
                                    <li><label><input type="checkbox" name="neigborhood[]" value="brooklyn"/><b></b>Speakeasy</label></li>
                                </ul>
                                <br class="clear"/>
                            </div>
                        </li>
                    </ul>

                    <div class="submit s-margin-top">
                        <input type="submit" value="Apply Filters"/>
                    </div>
                </form>
            </aside>

            <div class="nine columns bar-filter-form">
                {% if is_mobile() and not is_tablet() %}
                    <h1>Search results</h1>
                    <div class="five columns m-margin">
                        <form id="search">
                            <input type="text" name="city" placeholder="Type your city name..."/>
                            <input type="submit" class="search" value=" "/>
                            <input type="reset" value=" "/>
                        </form>
                    </div>
                {% endif %}

                <div class="six columns h2">
                    <input type="radio" name="filter" value="(14) bars" checked="checked" class="ui-radio" data-color="brown" data-type="collapsed"/>
                    <input type="radio" name="filter" value="(10) articles" class="ui-radio" data-color="brown" data-type="collapsed"/>
                </div>

                <div class="six columns sort-by h3">
                    {% if is_mobile() and not is_tablet() %}
                        <a class="btn-radius border brown filter-btn">Filter</a>
                    {% endif %}
                    <input type="radio" name="view-type" value="grid" class="ui-radio with-icon" data-color="brown" checked="checked"/>
                    <input type="radio" name="view-type" value="list" class="ui-radio with-icon" data-color="brown"/>
                </div>
            </div>

            <section class="nine columns bar-filter m-margin-top">
                <div class="bars-w-pic force-load  {% if is_mobile() and not is_tablet() %}m-margin-top{% endif %} load-container">

                    <div class="load-target"></div>
                    <div class="twelve columns align-center m-margin load-more-container">
                        <a class="h4 btn-radius large border load-more brown">See more bars</a>
                    </div>
                </div>

                <div class="bars-w-pic-list load-container" style="display: none">


                    <div class="load-target"></div>
                    <div class="twelve columns align-center m-margin load-more-container">
                        <a class="h4 btn-radius large border load-more brown">See more bars</a>
                    </div>
                </div>
            </section>
        </div>

        <script>
            $(document).ready(function() {
                var moreResults = '{{ bar_results.more_results|raw }}';
                $('#load-more-results').on('click', function() {
                    $.ajax({
                        url: moreResults,
                        success: function(response) {
                            console.log(response);
                            moreResults = response.more_results;
                        }
                    });
                });
            });
        </script>

        <script type="text/javascript">
            $('input[name=view-type]').change(function()
            {
                if ($(this).val() == "grid")
                {
                    $('.bars-w-pic-list').fadeOut(200, 'easeInOutCubic', function()
                    {
                        $('.bars-w-pic').show();

                        var $elements = $('.bars-w-pic article');

                        $elements.addClass('enable3d').css({opacity: 0, top: '6em', position: 'relative'}).each(function(index) {

                            $(this).delay(60 * (index + 1)).velocity({opacity: 1, top: 0}, 600, 'easeInOutCubic');
                        });
                    });
                }
                else
                {
                    $('.bars-w-pic').fadeOut(200, 'easeInOutCubic', function()
                    {
                        $('.bars-w-pic-list').show();

                        var $elements = $('.bars-w-pic-list article');

                        $elements.addClass('enable3d').css({opacity: 0, top: '6em', position: 'relative'}).each(function(index) {

                            $(this).delay(100 * (index + 1)).velocity({opacity: 1, top: 0}, 600, 'easeInOutCubic');
                        });
                    });
                }
            });

            $('.filter-btn').click(function() {
                $('.bar-filter-form, .bar-filter').hide();
                $('aside.filters').fadeIn();
            });

            $('aside.filters input[type=reset]').click(function() {
                $('.bar-filter-form, .bar-filter').fadeIn();
                if ($(window).width() < 640)
                    $('aside.filters').hide();
            });
        </script>
    {% endblock %}
